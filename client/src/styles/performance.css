/* ========================================
   OPTIMIZACIONES DE RENDIMIENTO - EL NOPAL
   ======================================== */

/* ===============================
   RESET Y BASE OPTIMIZATIONS
   =============================== */

/* Optimizar box-sizing globalmente */
*,
*::before,
*::after {
  box-sizing: border-box;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Optimizar scroll */
html {
  scroll-behavior: smooth;
  text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizeLegibility;
  scroll-padding-top: 80px;
}

/* Base body optimizations */
body {
  margin: 0;
  padding: 0;
  overflow-x: hidden;
  min-height: 100vh;
  background-color: #ffffff;
  font-display: swap;
}

/* ===============================
   PERFORMANCE CRITICAL CLASSES
   =============================== */

/* GPU Acceleration para elementos animados */
.gpu-accelerated {
  will-change: transform;
  transform: translateZ(0);
  backface-visibility: hidden;
  perspective: 1000px;
}

/* Aplicar GPU acceleration a elementos críticos */
.hero-parallax,
.parallax-bg,
.card-3d,
.hero-content,
.floating-title {
  will-change: transform;
  transform: translateZ(0);
  backface-visibility: hidden;
}

/* Optimizar imágenes */
img {
  max-width: 100%;
  height: auto;
  display: block;
  image-rendering: -webkit-optimize-contrast;
  image-rendering: crisp-edges;
  loading: lazy;
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
}

/* Lazy loading optimization */
img[loading="lazy"] {
  opacity: 0;
  transition: opacity 0.3s;
}

img[loading="lazy"].loaded {
  opacity: 1;
}

/* ===============================
   VIEWPORT OPTIMIZATIONS
   =============================== */

/* Prevenir zoom horizontal */
.no-horizontal-scroll {
  overflow-x: hidden;
  max-width: 100vw;
}

/* Container fluid responsive */
.container-fluid {
  width: 100%;
  max-width: 100vw;
  margin: 0;
  padding: 0;
  overflow-x: hidden;
}

/* Safe area para dispositivos con notch */
.safe-area-padding {
  padding-left: env(safe-area-inset-left);
  padding-right: env(safe-area-inset-right);
  padding-top: env(safe-area-inset-top);
  padding-bottom: env(safe-area-inset-bottom);
}

/* ===============================
   TOUCH OPTIMIZATIONS
   =============================== */

/* Optimizar touch targets */
.touch-target {
  min-height: 44px;
  min-width: 44px;
  touch-action: manipulation;
}

/* Botones optimizados para touch */
.btn,
.nav-link,
.card-3d {
  touch-action: manipulation;
  -webkit-tap-highlight-color: transparent;
}

/* Eliminar delay de 300ms en mobile */
a,
button,
input,
textarea,
select {
  touch-action: manipulation;
}

/* ===============================
   SCROLLING OPTIMIZATIONS
   =============================== */

/* Scroll suave nativo */
.smooth-scroll {
  scroll-behavior: smooth;
  -webkit-overflow-scrolling: touch;
  scroll-padding-top: 100px;
}

/* Optimizar scroll en contenedores */
.scroll-container {
  overflow-y: auto;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
  scroll-behavior: smooth;
}

/* Ocultar scrollbars manteniendo funcionalidad */
.hide-scrollbar {
  -ms-overflow-style: none;
  scrollbar-width: none;
}

.hide-scrollbar::-webkit-scrollbar {
  display: none;
}

/* ===============================
   ANIMATION OPTIMIZATIONS
   =============================== */

/* Optimizar animaciones */
@media (prefers-reduced-motion: no-preference) {
  .animate-on-scroll {
    animation-fill-mode: both;
    animation-duration: 0.6s;
    animation-timing-function: ease-out;
  }
  
  .smooth-animation {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  .fast-animation {
    transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  .slow-animation {
    transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
  }
}

/* Deshabilitar animaciones para usuarios que las prefieren reducidas */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* ===============================
   LAYOUT SHIFT PREVENTION
   =============================== */

/* Prevenir layout shift en imágenes */
.aspect-ratio-16-9 {
  aspect-ratio: 16/9;
  object-fit: cover;
}

.aspect-ratio-4-3 {
  aspect-ratio: 4/3;
  object-fit: cover;
}

.aspect-ratio-1-1 {
  aspect-ratio: 1/1;
  object-fit: cover;
}

/* Reservar espacio para contenido dinámico */
.skeleton-loader {
  background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
  background-size: 200% 100%;
  animation: loading 1.5s infinite;
}

@keyframes loading {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

/* ===============================
   FONT OPTIMIZATIONS
   =============================== */

/* Optimizar carga de fuentes */
.font-display-swap {
  font-display: swap;
}

/* Fallback fonts */
.font-primary {
  font-family: 'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
}

.font-secondary {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
}

/* ===============================
   FORM OPTIMIZATIONS
   =============================== */

/* Optimizar inputs para mobile */
input,
textarea,
select {
  font-size: 16px; /* Previene zoom en iOS */
  border-radius: 0; /* Previene estilo nativo en iOS */
  -webkit-appearance: none;
  appearance: none;
}

/* Optimizar placeholders */
::placeholder {
  color: #999;
  opacity: 1;
}

/* ===============================
   MODAL OPTIMIZATIONS
   =============================== */

/* Prevenir scroll del body cuando modal está abierto */
.modal-open {
  overflow: hidden;
  height: 100vh;
}

/* Optimizar backdrop */
.modal-backdrop {
  backdrop-filter: blur(3px);
  -webkit-backdrop-filter: blur(3px);
}

/* ===============================
   GRID OPTIMIZATIONS
   =============================== */

/* Grid responsive con mejor soporte */
.responsive-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(min(300px, 100%), 1fr));
  gap: clamp(1rem, 3vw, 2rem);
}

/* Flexbox fallback para grids */
@supports not (display: grid) {
  .responsive-grid {
    display: flex;
    flex-wrap: wrap;
    margin: -0.5rem;
  }
  
  .responsive-grid > * {
    flex: 1 1 300px;
    margin: 0.5rem;
  }
}

/* ===============================
   ACCESSIBILITY OPTIMIZATIONS
   =============================== */

/* Focus visible para keyboard navigation */
.focus-visible {
  outline: 2px solid #4A90E2;
  outline-offset: 2px;
}

/* High contrast mode support */
@media (prefers-contrast: high) {
  .card-3d,
  .btn,
  .nav-link {
    border: 2px solid;
  }
}

/* Dark mode support - DISABLED
@media (prefers-color-scheme: dark) {
  :root {
    --bg-primary: #1a1a1a;
    --text-primary: #ffffff;
    --border-color: #333333;
  }
  
  body {
    background-color: var(--bg-primary);
    color: var(--text-primary);
  }
}
*/

/* ===============================
   CRITICAL CSS INLINING
   =============================== */

/* Above the fold critical styles */
.hero-critical {
  position: relative;
  height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: #2a1f1d;
  color: white;
}

.nav-critical {
  position: fixed;
  top: 0;
  width: 100%;
  z-index: 1000;
  background-color: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(10px);
}

/* ===============================
   PRINT OPTIMIZATIONS
   =============================== */

@media print {
  * {
    background: transparent !important;
    color: black !important;
    box-shadow: none !important;
    text-shadow: none !important;
  }
  
  body {
    font-size: 12pt;
    line-height: 1.4;
  }
  
  .no-print {
    display: none !important;
  }
  
  .page-break {
    page-break-before: always;
  }
  
  .page-break-inside {
    page-break-inside: avoid;
  }
}

/* ===============================
   BROWSER SPECIFIC FIXES
   =============================== */

/* Safari specific fixes */
@supports (-webkit-appearance: none) {
  .safari-fix {
    -webkit-transform: translateZ(0);
  }
}

/* Firefox specific fixes */
@-moz-document url-prefix() {
  .firefox-fix {
    scrollbar-width: thin;
  }
}

/* Chrome specific fixes */
@media screen and (-webkit-min-device-pixel-ratio: 0) {
  .chrome-fix {
    backface-visibility: hidden;
  }
}

/* ===============================
   FALLBACKS PARA NAVEGADORES ANTIGUOS
   =============================== */

/* CSS Grid fallback */
@supports not (display: grid) {
  .grid-fallback {
    display: flex;
    flex-wrap: wrap;
  }
  
  .grid-fallback > * {
    flex: 1 1 calc(33.333% - 1rem);
    margin: 0.5rem;
  }
}

/* CSS Variables fallback */
.no-css-variables .primary-color {
  color: #D62828;
}

.no-css-variables .secondary-color {
  color: #006B3C;
}

.no-css-variables .accent-color {
  color: #F8B612;
}

/* ===============================
   INTERSECTION OBSERVER FALLBACK
   =============================== */

.no-intersection-observer .animate-on-scroll {
  opacity: 1;
  transform: none;
}

/* ===============================
   PERFORMANCE MONITORING
   =============================== */

/* Marcar elementos para performance monitoring */
.perf-measure {
  /* Usado para medir rendimiento con JavaScript */
}

/* ===============================
   RESPONSIVE IMAGES
   =============================== */

/* Picture element optimization */
picture {
  display: block;
  width: 100%;
}

picture img {
  width: 100%;
  height: auto;
  object-fit: cover;
}

/* Srcset optimization */
.responsive-image {
  width: 100%;
  height: auto;
  object-fit: cover;
  object-position: center;
}

/* ===============================
   FINAL OPTIMIZATIONS
   =============================== */

/* Contenedor principal optimizado */
.app-container {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  overflow-x: hidden;
}

/* Main content area */
.main-content {
  flex: 1;
  width: 100%;
  max-width: 100vw;
}

/* Optimización final para contenido */
.content-wrapper {
  width: 100%;
  max-width: 100%;
  margin: 0 auto;
  overflow-x: hidden;
}

/* === OPTIMIZACIONES DE RENDIMIENTO CSS === */

/* Configuración para elementos que van a ser animados */
.will-animate,
.card-3d,
.hero-parallax,
.fade-in,
.slide-in,
.zoom-in {
  /* Habilitar aceleración de hardware */
  will-change: transform, opacity;
  backface-visibility: hidden;
  perspective: 1000px;
  transform-style: preserve-3d;
}

/* Optimizar transformaciones */
.gpu-accelerated {
  transform: translateZ(0);
  will-change: transform;
}

/* === OPTIMIZACIONES DE ANIMACIONES === */

/* Configuración base para animaciones fluidas */
@media (prefers-reduced-motion: no-preference) {
  .smooth-animation {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  .fast-animation {
    transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  .slow-animation {
    transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
  }
}

/* === OPTIMIZACIONES DE SCROLL === */

/* Elementos que aparecen en scroll */
.scroll-reveal {
  opacity: 0;
  transform: translateY(30px);
  transition: opacity 0.6s ease, transform 0.6s ease;
}

.scroll-reveal.revealed {
  opacity: 1;
  transform: translateY(0);
}

/* === OPTIMIZACIONES DE LAYOUT === */

/* Prevenir layout shift en containers */
.stable-container {
  contain: layout style paint;
}

/* Grid y flexbox optimizados */
.optimized-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 1.5rem;
  contain: layout;
}

.optimized-flex {
  display: flex;
  contain: layout;
}

/* === OPTIMIZACIONES DE FUENTES === */

/* Carga de fuentes optimizada */
@font-display: swap;

/* === OPTIMIZACIONES PARA MÓVILES === */

/* Touch optimizations */
.touch-optimized {
  -webkit-tap-highlight-color: transparent;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  user-select: none;
  touch-action: manipulation;
}

/* === OPTIMIZACIONES DE RENDIMIENTO DE CSS === */

/* Contain para elementos independientes */
.card,
.modal,
.sidebar {
  contain: content;
}

/* Optimización para elementos fuera de viewport */
.offscreen {
  contain: strict;
  content-visibility: auto;
}

/* === OPTIMIZACIONES DE CRÍTICO CSS === */

/* Estilos críticos para above-the-fold */
.critical-section {
  /* Priorizar renderizado */
  will-change: auto;
  contain: layout style;
}

/* === LOADING STATES OPTIMIZADOS === */

/* Skeleton loading */
.skeleton {
  background: linear-gradient(110deg, #ececec 8%, #f5f5f5 18%, #ececec 33%);
  background-size: 200% 100%;
  animation: skeleton-loading 1.5s ease-in-out infinite;
}

@keyframes skeleton-loading {
  0% {
    background-position: -200% 0;
  }
  100% {
    background-position: 200% 0;
  }
}

/* === OPTIMIZACIONES PARA DISPOSITIVOS DE ALTA DPI === */

@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
  .high-dpi-optimized {
    /* Optimizaciones específicas para pantallas retina */
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
  }
  
  /* Imágenes optimizadas para retina */
  .hero-image {
    image-rendering: -webkit-optimize-contrast;
  }
}

/* === OPTIMIZACIONES DE MEMORIA === */

/* Liberar memoria de elementos no visibles */
.lazy-section {
  content-visibility: auto;
  contain-intrinsic-size: 400px;
}

/* === OPTIMIZACIONES DE CPU === */

/* Usar compositing layers solo cuando sea necesario */
.compositing-layer {
  will-change: transform;
  transform: translateZ(0);
}

/* Eliminar will-change después de animación */
.animation-finished {
  will-change: auto;
}

/* === OPTIMIZACIONES PARA PWA === */

/* Optimizaciones para Progressive Web App */
.pwa-optimized {
  /* Mejorar la percepción de velocidad */
  content-visibility: auto;
  contain-intrinsic-size: 200px;
}

/* === OPTIMIZACIONES DE RED === */

/* Preload para recursos críticos */
.preload-hint {
  /* Hint al navegador para precargar */
  contain: layout style paint;
}

/* === FALLBACKS DE RENDIMIENTO === */

/* Fallback para navegadores que no soportan content-visibility */
@supports not (content-visibility: auto) {
  .offscreen {
    /* Fallback tradicional */
    transform: translateZ(0);
  }
}

/* Fallback para contain */
@supports not (contain: layout) {
  .stable-container {
    /* Fallback sin contain */
    overflow: hidden;
  }
}

/* === OPTIMIZACIONES ESPECÍFICAS PARA EL PROYECTO === */

/* Optimizaciones para las cards 3D */
.card-3d {
  /* Optimizar transformaciones 3D */
  transform-style: preserve-3d;
  backface-visibility: hidden;
  will-change: transform;
  /* Mejorar el rendering en móviles */
  -webkit-transform-style: preserve-3d;
  -webkit-backface-visibility: hidden;
}

/* Optimizaciones para el hero parallax */
.hero-parallax {
  /* Optimizar el efecto parallax */
  will-change: transform;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
}

/* Optimizaciones para modals */
.modal {
  /* Aislar el rendering del modal */
  contain: layout style paint;
  will-change: transform, opacity;
}

/* Optimizaciones para el navbar */
.navbar {
  /* Optimizar el navbar fijo */
  contain: layout style;
  will-change: transform;
  backface-visibility: hidden;
}

/* === OPTIMIZACIONES DE ACCESIBILIDAD === */

/* Respetar preferencias del usuario */
@media (prefers-contrast: high) {
  .performance-optimized {
    /* Desactivar optimizaciones que puedan afectar el contraste */
    will-change: auto;
    filter: none;
  }
}

@media (prefers-color-scheme: dark) {
  .skeleton {
    background: linear-gradient(110deg, #2a2a2a 8%, #3a3a3a 18%, #2a2a2a 33%);
  }
}

/* === RESET DE OPTIMIZACIONES EN MODO DEBUG === */

.debug-mode * {
  will-change: auto !important;
  contain: none !important;
  content-visibility: visible !important;
} 